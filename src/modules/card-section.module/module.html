{% set CARD_ALIGNMENT_CLASSES = {
    'LEFT': 'cards--left',
    'CENTER': 'cards--center',
    'RIGHT': 'cards--right'
  }
%}

<div class="cards {{ module.style.alignment_spacing.alignment.horizontal_align ? CARD_ALIGNMENT_CLASSES[module.style.alignment_spacing.alignment.horizontal_align] : CARD_ALIGNMENT_CLASSES['CENTER'] }}">
  {% for card in module.card %}
    <section class="cards__card card">
      {% if card.image.src %}
        {% set sizeAttrs = 'width="{{ card.image.width }}" height="{{ card.image.height }}"' %}
        {% if card.image.size_type == 'auto' %}
          {% set sizeAttrs = 'style="max-width: 100%; height: auto;"' %}
        {% elif card.image.size_type == 'auto_custom_max' %}
          {% set sizeAttrs = 'width="{{ card.image.max_width }}" height="{{ card.image.max_height }}" style="max-width: 100%; max-height: auto;"' %}
        {% endif %}
         {% set loadingAttr = card.image.loading != 'disabled' ? 'loading="{{ card.image.loading }}"' : '' %}
        <img class="card__image" src="{{ card.image.src }}" alt="{{ card.image.alt }}" {{ loadingAttr }} {{ sizeAttrs }}>
      {% endif %}
      <div class="card__text">
        {% if card.title %}
          <{{ card.title_heading_type }}>{{ card.title }}</{{ card.title_heading_type }}>
        {% endif %}
        {% if card.text %}
          <p>{{ card.text }}</p>
        {% endif %}
      </div>
    </section>
  {% endfor %}
</div>

<style>
{% scope_css %}
  .card {
    {{ module.style.alignment_spacing.spacing.css }}
    {% if module.style.background.bg_type == "bg_color" && module.style.background.bg_color.color %}
        background-color: {{ module.style.background.bg_color.color }};
    {% endif %}
    {% if module.style.background.bg_type == "bg_gradient" && module.style.background.bg_gradient.css %}
      background: {{ module.style.background.bg_gradient.css }};
    {% endif %}
    {% if module.style.background.bg_type == "bg_image" %}
      {{ module.style.background.bg_image.css }}
    {% endif %}
    {{ module.style.border.css }}
    {% if module.style.typography.font.size %}
      font-size:{{module.style.typography.font.size.value}}{{module.style.typography.font.size.units}};
    {% endif %}
    {% if module.style.typography.font.color %}
      color:{{module.style.typography.font.color}};
    {% endif %}
    {# Font style string is missing last semicolon #}
    {% if  module.style.typography.font.style %}
      {{ module.style.typography.font.style }};
    {% endif %}
  }
{% end_scope_css%}
</style>
